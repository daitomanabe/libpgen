
# 知らなかったこと

今日は「C++のためのAPIデザイン」をよんで必要になりそうなところをすこしまとめた。


## ケン・プーの「インターフェースの三原則」

 1. インターフェースの実装は、そのメソッドが示すとうりの処理を行わなければならない
 1. インターフェースの実装は、他に危害を加えてはならない。
 1. インターフェースの実装は、自分の責任を果たせない場合、そのことを呼び出し元に伝えなければならない

三つ目の対処方法を以下に示す。

 1. エラーコードを返す (これはc的考えかた)
 1. 例外を投げる (これを採用していきたい)
 1. プログラムを停止する (これは極力さけたい)

エラー報告の方法を一貫させて、ドキュメント化をしておく必要がある



## ドキュメント化について

最小限ドキュメントを見ればうまく使える。サンプルに頼らずに使えるライブラリを設計していきたい。
だが、最低限のドキュメントは必要。そのようなドキュメントの作成方法の手法


## クラス設計

継承は多階層化させないようにする。(多くても2-3くらい)
てことはプロトコルごとのクラスの継承表現は問題があるのではないか。。
is-aは問題ありっぽいので、has-a的な考え方にしますか。。。

### メンバ変数について

プロトコル要素メンバ変数は全てprivate変数にすること。全ての要素に対してsetter, getterを使用して実装する。
***インターフェースをどのようにするかはあとあと考えてもいいので***まずは変数の扱いなどを安定させる。

***アイディア***

メンバ変数を種類ごと(bit長、アドレスやポート)にクラスとして実装して、依存がある要素は特別に優遇させる


### パケットクラスの実装例

```
class packet {
	private:
		/* packet binary datas  */
		/* packet binary length */
	public:
		void*  raw();      /* packet binary datas */
		size_t length();   /* packet binary length */
		bool   correct();  /* is correct packet */
		virtual void summary();
		virtual void info();
		virtual void compile();
};
```



## バイト列の管理をvectorなどの可変長なもので行うようにする。

これはまだノープラン。vectorの使い方すら微妙なので。




